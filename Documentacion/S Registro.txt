
title IU 3 SignIn 

actor Usuario
participant index.js
participant App.js
participant ViewRenderer.jsx
participant SignIn.jsx
participant react
participant Firebase Auth
participant Firestore

App.js->ViewRenderer.jsx:<ViewRenderer\n  currentView={"signIn"}\n  setCurrentView={setCurrentView}\n  currentUser={currentUser}\n  handleSignOut={handleSignOut}\n  error={error}\n  setError={setError}\n/>
ViewRenderer.jsx->SignIn.jsx:<SignIn {\n    setCurrentView,\n    error,\n    setError\n  } />

SignIn.jsx->react:useState({ email, password, confirmPassword })
react-->SignIn.jsx:[formData, setFormData]
SignIn.jsx->react:useState(false)
react-->SignIn.jsx:[loading, setLoading]

ViewRenderer.jsx<--SignIn.jsx:JSX formulario registro
App.js<--ViewRenderer.jsx:JSX
App.js-->index.js:JSX
Usuario<--index.js:Ve formulario de registro

alt Usuario ingresa email
    Usuario->SignIn.jsx:onChange campo email
    SignIn.jsx->react:setFormData(prev => ({...prev, email: value}))
    react-->SignIn.jsx:actualizar estado
    Usuario<--SignIn.jsx:Campo actualizado
end

alt Usuario ingresa password
    Usuario->SignIn.jsx:onChange campo password
    SignIn.jsx->react:setFormData(prev => ({...prev, password: value}))
    react-->SignIn.jsx:actualizar estado
    Usuario<--SignIn.jsx:Campo actualizado
end

alt Usuario confirma contraseña
    Usuario->SignIn.jsx:onChange campo confirmPassword
    SignIn.jsx->react:setFormData(prev => ({...prev, confirmPassword: value}))
    react-->SignIn.jsx:actualizar estado
    Usuario<--SignIn.jsx:Campo actualizado
end

alt Usuario hace click en "Registrarse"
    Usuario->SignIn.jsx:onClick botón "Registrarse"

    alt validación exitosa
        SignIn.jsx->react:setLoading(true)
        react-->SignIn.jsx:return
        SignIn.jsx->react:setError(null)
        react-->SignIn.jsx:return

        SignIn.jsx->>Firebase Auth:createUserWithEmailAndPassword(auth,         email, password)
        Firebase Auth-->>SignIn.jsx:userCredential

        SignIn.jsx->>Firestore:setDoc("usuarios/{uid}", { email,                datosCompletos: false, fechaRegistro })
        Firestore-->>SignIn.jsx:Documento creado

        SignIn.jsx->react:setCurrentView("formularioDatos")
        react-->SignIn.jsx:return
        ==Ir a index inicia==

    else validación fallida
        SignIn.jsx->react:setError(mensaje)
        react-->SignIn.jsx:return
        Usuario<--SignIn.jsx:Ve mensaje de error de validación
    

    else error de Firebase
        Firebase Auth-->>SignIn.jsx:error
        SignIn.jsx->react:setError(errorMessage)
        SignIn.jsx<--react:return
        SignIn.jsx->react:setLoading(false)
        SignIn.jsx<-react:return
        Usuario<--SignIn.jsx:Ve mensaje de error de Firebase
    end

else Usuario hace click en "Ya tengo cuenta"
    Usuario->SignIn.jsx:click en botón de inicio de sesión
    SignIn.jsx->react:setCurrentView("login")
    ==Ir a index inicia==
    
else Usuario hace click en "Volver al menú"
    Usuario->SignIn.jsx:click en botón de Menú
    SignIn.jsx->react:setCurrentView("menu")
    ==Ir a index inicia==
end